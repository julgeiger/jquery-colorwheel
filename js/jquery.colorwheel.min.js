/*! jQuery Colorwheel Plugin - v1.0 - 07/01/2013
* https://github.com/stdevteam/jquery-colorwheel
* Copyright (c) 2013 STDev (http://st-dev.com); Licensed MIT */
(function(c){var a=false,b=1;c.fn.colorWheel=function(e){if(a===false){e=c.extend(c.fn.colorWheel.defaults,e);this.each(function(){var f=c(this);c.fn.colorWheel.handlers[b]=new d();f.data("handlersIndex",b);c.fn.colorWheel.handlers[b].init(f,e)});if(e.enableKeyboardShortcuts===true){a=true}b++}return this};c.fn.colorWheel.defaults={controlsSelector:".wheel-controls",wheelWidth:553,pickedColorLables:["Picked color"],initialColors:["#222222","#444444","#666666","#888888","#999999","#aaaaaa","#bbbbbb","#cccccc","#dddddd","#eeeeee"],addInputs:true,addLabels:true,enableKeyboardShortcuts:true,pickContElement:"div",pickLabelElement:"strong",pickTextElement:"span",pickItemTitleText:"Click to change this color"};c.fn.colorWheel.handlers=[];var d=function(e){this.$this=null,this.hue=60;this.adeg=60;this.saturation=1,this.value=1,this.initialWidth=553;this.initialHeight=257;this.multiplier=1;this.squarecolor="#ffff00",this.pickindex=0,this.colorContInnerElement="span";this.threeColors=new Array("#666666","#555555","#545657"),this.prevColor=null,this.pickedColors=[],this.initialColors=[],this.$wheel=null,this.$controls=null,this.options={},this.init=function(g,f){this.$wheel=g;this.options=f;this.processWheelDimensions();this.processControlsArea();this.processColorContainers();this.prevColor=this.threeColors[2];this.bindHandlers();this.$this=this},this.setOptions=function(f){this.options=f},this.setPickIndex=function(f){this.pickindex=f},this.getOption=function(f){if(typeof this.options.option!="undefined"){return this.options.option}else{return null}},this.bindHandlers=function(){if(this.options.enableKeyboardShortcuts){c(document).keydown(function(g){var f=c.fn.colorWheel.handlers.slice(-1)[0];f.rotate(g)})}this.$wheel.click(function(g){var f=c.fn.colorWheel.handlers[c(this).data("handlersIndex")];f.pickColor(g)});this.$wheel.mousemove(function(g){var f=c.fn.colorWheel.handlers[c(this).data("handlersIndex")];f.mouseMoved(g)});this.$wheel.mouseout(function(g){var f=c.fn.colorWheel.handlers[c(this).data("handlersIndex")];f.wheelMouseOut(g)})},this.processControlsArea=function(){this.$controls=c(this.options.controlsSelector);if(this.$controls.size()<=0){alert("Control area selector needs to be specified");this.$wheel.after(c("<div />").addClass(c.fn.colorWheel.defaults.controlsSelector));this.options.controlsSelector=c.fn.colorWheel.defaults.controlsSelector;this.$controls=c("."+c.fn.colorWheel.defaults.controlsSelector)}},this.processWheelDimensions=function(){var f=this.options,g;this.multiplier=this.initialWidth/f.wheelWidth;g=this._divide(this.initialHeight);this.$wheel.css({width:f.wheelWidth,height:g});this.$wheel.find("img").css({width:f.wheelWidth,height:g})},this.processColorContainers=function(){this.initialColors=this.options.initialColors;var j,f,g=this.options.pickTextElement,o=this.options.pickContElement,n=this.options.pickLabelElement,u=0,r=this.initialColors.length,p=c("<div />").attr("id","pickset"),h,t,s,k=this.options.pickedColorLables,m="picker-"+this.getHandlerIndex()+"-";this.colorContInnerElement=((this.options.addInputs)?"input":"span");if(k.length<=0){alert("At least one label needs to be specified for 'pickedColorLables'");k=c.fn.colorWheel.defaults.pickedColorLables}var q;for(var l in k){q=k[l];c.fn.colorWheel.handlers[this.getHandlerIndex()].pickedColors.push({id:m+l,label:q})}for(j=0;j<this.pickedColors.length;j++){if(j>=r){u=r-j}else{u=j}h=c("<"+o+" />").attr("id",this.pickedColors[j].id).attr("title",this.options.pickItemTitleText).addClass("picker-item").css({backgroundColor:this.initialColors[u]});this.pickedColors[j].lastColor=this.initialColors[u];f="<"+g+' class="wtxt">'+this.initialColors[u]+"</"+g+"><br><"+g+' class="btxt">'+this.initialColors[u]+"</"+g+">";if(this.options.addLabels){s=c("<"+n+" />").attr("id",this.pickedColors[j].id+"-label").addClass("picker-item-label").text(this.pickedColors[j].label);h.append(s)}if(this.options.addInputs){t=c("<input />").attr("id",this.pickedColors[j].id+"-color-cont").attr("name",this.pickedColors[j].id+"-color-cont").addClass("picker-item-color-cont").val(this.initialColors[u])}else{t=c("<"+g+" />").attr("id",this.pickedColors[j].id+"-color-cont").addClass("picker-item-color-cont").text(this.initialColors[u])}h.append(t);h.data("indexData",{pickerIndex:j,handlerIndex:this.getHandlerIndex()});p.append(h)}this.$controls.append(p);c(".picker-item").click(function(){var v=c(this).data("indexData"),i=c.fn.colorWheel.handlers[v.handlerIndex];i.setPickIndex(v.pickerIndex)})};this.getHandlerIndex=function(){return this.$wheel.data("handlersIndex")};this.hsv2rgb=function(j,k,i){var p,l,r,g,n,m,f,t,s,h,o,q;p=j/360;if(k==0){l=i*255;r=i*255;g=i*255}else{n=p*6;m=Math.floor(n);f=i*(1-k);t=i*(1-k*(n-m));s=i*(1-k*(1-(n-m)));if(m==0){h=i;o=s;q=f}else{if(m==1){h=t;o=i;q=f}else{if(m==2){h=f;o=i;q=s}else{if(m==3){h=f;o=t;q=i}else{if(m==4){h=s;o=f;q=i}else{h=i;o=f;q=t}}}}}l=Math.round(h*255);r=Math.round(o*255);g=Math.round(q*255)}return new Array(l,r,g)},this.rgb2hex=function(h){var g,f;g=new Array;g[3]="#";for(f=0;f<3;f++){g[f]=parseInt(h[f]).toString(16);if(g[f].length<2){g[f]="0"+g[f]}g[3]=g[3]+g[f];g[f+4]=h[f]}return g},this.webRounder=function(l,k){var j="#",h,g,f;for(h=0;h<3;h++){g=Math.round(l[h+4]/k)*k;f=g.toString(16);if(String(f).length<2){f="0"+f}j+=f}return j},this.hexColorArray=function(f){this.threeColors[2]=f[3];this.threeColors[1]=this.webRounder(f,17);this.threeColors[0]=this.webRounder(f,51);return false},this.greyMoved=function(f,j){var h,g,i;this.adeg=this.hue;h=(f<=553)?f-296:256;g=(j<=256)?j:256;this.saturation=h/256;this.value=1-(g/256);i=this.rgb2hex(this.hsv2rgb(this.hue,this.saturation,this.value));this.hexColorArray(i);this.hoverColor();return false},this.mouseMoved=function(o){var m=this.$wheel.offset();var t=this._multiply(o.pageX-m.left),s=this._multiply(o.pageY-m.top),j,i,n,h,r,k,v,g,f,q,l,u,p;if(t>=296){this.greyMoved(t,s);return false}if(s>256){return false}j=t-128;i=128-s;n=j*j;h=i*i;r=(j<0)?-1:1;k=(i<0)?-1:1;v=j/128;g=Math.sqrt(n+h);f=g/128;if(g==0){this.saturation=0;this.value=0;q=new Array(0,0,0)}else{l=Math.acos(j/g);u=(i>=0)?l:2*Math.PI-l;this.adeg=360*u/(2*Math.PI);if(f>1){q=new Array(255,255,255);this.saturation=1;this.value=1}else{if(f>=0.5){this.saturation=1-((f-0.5)*2);this.value=1;q=this.hsv2rgb(this.adeg,this.saturation,this.value)}else{this.saturation=1;this.value=f*2;q=this.hsv2rgb(this.adeg,this.saturation,this.value)}}}p=this.rgb2hex(q);this.hexColorArray(p);this.hoverColor();return false},this.wheelMouseOut=function(){c("#"+this.pickedColors[this.pickindex].id).css({backgroundColor:this.pickedColors[this.pickindex].lastColor});if(this.options.addInputs){c("#"+this.pickedColors[this.pickindex].id).find(this.colorContInnerElement).val(this.pickedColors[this.pickindex].lastColor)}else{c("#"+this.pickedColors[this.pickindex].id).find(this.colorContInnerElement).text(this.pickedColors[this.pickindex].lastColor)}return false},this.hoverColor=function(){c("#"+this.pickedColors[this.pickindex].id).css({backgroundColor:this.threeColors[1]});if(this.options.addInputs){c("#"+this.pickedColors[this.pickindex].id).find(this.colorContInnerElement).val(this.threeColors[1])}else{c("#"+this.pickedColors[this.pickindex].id).find(this.colorContInnerElement).text(this.threeColors[1])}return false},this.pickColor=function(h){var g,f;if(this.threeColors[2]==this.prevColor){return false}this.prevColor=this.threeColors[2];if(this.options.addInputs){c("#"+this.pickedColors[this.pickindex].id).find(this.colorContInnerElement).val(this.threeColors[1])}else{c("#"+this.pickedColors[this.pickindex].id).find(this.colorContInnerElement).text(this.threeColors[1])}c("#"+this.pickedColors[this.pickindex].id).css({backgroundColor:this.threeColors[1]});this.pickedColors[this.pickindex].lastColor=this.threeColors[1];this.pickindex+=1;if(this.pickindex>=this.pickedColors.length){this.pickindex=0}this.setSquare(this.adeg);return false},this.setSquare=function(f){var g;this.hue=f;this.adeg=f;g=this.rgb2hex(this.hsv2rgb(this.hue,1,1));this.squarecolor=g[3];c("#wheel").css({backgroundColor:this.squarecolor})},this.rotate=function(g){var f=g.which;this.handleKP(f)},this.handleKP=function(f){switch(f){case 13:this.reHue(this.hue);this.pickColor();break;case 112:this.reHue(this.hue);this.pickColor();break;case 114:this.reHue(0);break;case 121:this.reHue(60);break;case 103:this.reHue(120);break;case 99:this.reHue(180);break;case 98:this.reHue(240);break;case 109:this.reHue(300);break;case 106:this.reHue(this.hue+1);break;case 104:this.reHue(this.hue+1);break;case 107:this.reHue(this.hue+355);break;case 116:this.reHue(this.hue+355);break;case 108:this.reHue(this.hue+359);break;case 110:this.reHue(this.hue+359);break;case 80:this.reHue(this.hue);this.pickColor();break;case 82:this.reHue(0);break;case 89:this.reHue(60);break;case 71:this.reHue(120);break;case 67:this.reHue(180);break;case 66:this.reHue(240);break;case 77:this.reHue(300);break;case 74:this.reHue(this.hue+1);break;case 72:this.reHue(this.hue+1);break;case 75:this.reHue(this.hue+355);break;case 84:this.reHue(this.hue+355);break;case 76:this.reHue(this.hue+359);break;case 78:this.reHue(this.hue+359);break}return false},this.reHue=function(g){var f,h;g=g%360;this.setSquare(g);f=this.hsv2rgb(g,this.saturation,this.value);h=this.rgb2hex(f);this.hexColorArray(h);this.hoverColor();return false};this._multiply=function(f){return parseInt(Math.floor(f*this.multiplier))};this._divide=function(f){return parseInt(Math.floor(f/this.multiplier))}}})(jQuery);